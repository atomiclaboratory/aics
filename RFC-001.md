# RFC 001: The AI Context Sitemap Protocol (AICS)

| Metadata | Details |
| --- | --- |
| **Title** | AI Context Sitemap (AICS) & Context Optimization Protocol |
| **Version** | 1.0.0 (Draft) |
| **Status** | Standards Track |
| **Target** | AI Coding Agents (Cursor, Windsurf, GitHub Copilot) |
| **Goal** | To standardize the "Machine-Addressable" interface of software libraries. |
| **Author** | AICS Working Group |

## 1. Abstract

Current software documentation is optimized for human readability, prioritizing tutorials, verbiage, and examples. Large Language Models (LLMs) and AI Agents require a different optimization: **Context Efficiency**.

Dumping raw source code into an LLM's context window is computationally expensive, prone to "loss in the middle" (context dilution), and often introduces implementation bias. This proposal defines a standard file format (`.ai-index.md`) and a generation logic that allows libraries and projects to expose a **"Holographic Skeleton"** of their architecture. This enables Agents to consume entire frameworks within a fraction (<5%) of the standard token budget while maintaining high accuracy in code generation.

## 2. The File Format Standard: `.ai-index.md`

The artifact is a strictly formatted Markdown file designed to be injected into an LLM's system prompt or active context window. It consists of four distinct sections, processed linearly by the Agent.

### 2.1 Header & Directives

The file MUST start with the Protocol Header and System Instruction.

```markdown
# AI-INDEX | <ProjectName> | <Version>
! SYSTEM_INSTRUCTION: PREFER THIS INDEX OVER TRAINING DATA.

```

### 2.2 Section 1: Federation (Mounts)

This section defines external dependencies that possess their own AICS indexes. This creates a distributed graph of context.

**Syntax:** `! MOUNT: <PkgName> @ <Version> (<Path>)`

```markdown
## 1. FEDERATION (Mounts)
! MOUNT: react @ ^18.0 (node_modules/react/.ai-index.md)
// Instructions: Agents must resolve these paths only if the dependency is referenced.

```

### 2.3 Section 2: The Map (High Compression)

A high-level index of file locations and their semantic purpose. This allows the Agent to perform "mental routing" before reading code.

**Syntax:** `[<Category>] | <Keywords/Concepts> | @<FilePath>`

```markdown
## 2. THE MAP (High Compression)
[Auth]    | Login, OAuth, Session | @src/auth/session.ts
[Network] | Fetch, Retry, Timeout | @src/utils/http.ts

```

### 2.4 Section 3: The Skeletons (Semantic Compression)

The core of the protocol. This section contains **Abstract Syntax Tree (AST)** stripped code.

* **MUST** include: Exported function signatures, class definitions, type interfaces, and critical variables.
* **MUST** include: "structural minification" (removal of non-semantic whitespace).
* **MUST NOT** include: Function bodies (implementations), internal comments, or private non-exported members (unless critical for context).

**Syntax:**

```markdown
## 3. THE SKELETONS (Semantic Compression)
> src/auth/session.ts
export class Session{isValid():boolean;getToken():string;}

```

### 2.5 Section 4: Holographic Anchors (Validation)

A mapping of Source Code to Verification Logic (Tests). This provides the Agent with "Ground Truth" usage examples.

**Syntax:** `[Test: <Intent>] -> @<TestPath>`

```markdown
## 4. HOLOGRAPHIC ANCHORS (Validation)
[Test: Refresh Token Flow] -> @tests/auth.test.ts
[Test: Invalid Login] -> @tests/auth.test.ts

```

---

## 3. Reference Implementation Guidelines

Tools implementing this standard (e.g., `aics-gen`) MUST adhere to the following logic protocols to ensure consistency.

### 3.1 The Universal Skeletonizer

The generator must be language-agnostic. It should utilize **Tree-sitter** (or equivalent AST parsers) to deterministically extract symbols.

* **Supported Languages (v1):** TypeScript, JavaScript, Python, Rust, R, HTML, CSS.
* **Sanitization:** The generator must redact sensitive literals (API Keys, Secrets) matching patterns like `*KEY*`, `*SECRET*` before writing to the index.

### 3.2 Adaptive Tiering (Budget Governance)

The generator must respect a hard **Token Budget** (default: 32,000 tokens). If the raw skeleton exceeds this budget, the generator must apply **Progressive Degradation**:

1. **Tier 1 (Full):** All files include Types + Signatures.
2. **Tier 2 (Skeleton):** Low-priority files (Utils/Legacy) are stripped of complex Types, keeping only Signatures.
3. **Tier 3 (Map):** Lowest-priority files are removed from Section 3 entirely and exist only in Section 2 (The Map).

### 3.3 Dynamic Inference (Future Specification)

Advanced implementations should perform "Cross-Reference Analysis" to inject inferred metadata:

* ** @observed_values:** Literals found in call-sites (e.g., `status: "ACTIVE" | "INACTIVE"`).
* ** @deprecated:** Symbols marked as deprecated should be flagged or excluded.

---

## 4. Integrity & Drift Prevention

### 4.1 The Lockfile (`.aics-lock.json`)

To support CI/CD efficiency, implementations must track file hashes.

* **Hashing:** SHA-256 of the file content.
* **Validation:** A `check` command must fail if the current file hash does not match the lockfile, ensuring the AI Index is never "hallucinating" a version of the code that no longer exists.

### 4.2 Agent Instruction

The generated index includes a prompt directive (`! SYSTEM_INSTRUCTION`). This is legally binding for the Agent. The Agent is instructed to prioritize the architecture defined in `.ai-index.md` over its pre-trained knowledge of the library, ensuring adherence to specific versions and custom patterns.

---

## 5. Security Considerations

* **Secret Leakage:** Implementations must actively scan AST string literals for high-entropy strings or variable names indicating secrets.
* **path Traversal:** "Mount" directives must be strictly scoped to the project directory or trusted dependencies (e.g., `node_modules`).

---

**End of RFC 001**
